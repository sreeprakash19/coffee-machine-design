{"version":3,"file":"color.js","sourceRoot":"","sources":["../../../../../src/compile/mark/encode/color.ts"],"names":[],"mappings":"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","sourcesContent":["import * as log from '../../../log';\nimport {contains, getFirstDefined} from '../../../util';\nimport {VgEncodeEntry} from '../../../vega.schema';\nimport {getMarkConfig} from '../../common';\nimport {UnitModel} from '../../unit';\nimport {nonPosition} from './nonposition';\n\nexport function color(model: UnitModel): VgEncodeEntry {\n  const {markDef, encoding, config} = model;\n  const {filled, type: markType} = markDef;\n\n  const configValue = {\n    fill: getMarkConfig('fill', markDef, config),\n    stroke: getMarkConfig('stroke', markDef, config),\n    color: getMarkConfig('color', markDef, config)\n  };\n\n  const transparentIfNeeded = contains(['bar', 'point', 'circle', 'square', 'geoshape'], markType)\n    ? 'transparent'\n    : undefined;\n\n  const defaultFill = getFirstDefined(\n    markDef.fill,\n    filled === true ? markDef.color : undefined,\n    configValue.fill,\n    filled === true ? configValue.color : undefined,\n    // If there is no fill, always fill symbols, bar, geoshape\n    // with transparent fills https://github.com/vega/vega-lite/issues/1316\n    transparentIfNeeded\n  );\n\n  const defaultStroke = getFirstDefined(\n    markDef.stroke,\n    filled === false ? markDef.color : undefined,\n    configValue.stroke,\n    filled === false ? configValue.color : undefined\n  );\n\n  const colorVgChannel = filled ? 'fill' : 'stroke';\n\n  const fillStrokeMarkDefAndConfig: VgEncodeEntry = {\n    ...(defaultFill ? {fill: {value: defaultFill}} : {}),\n    ...(defaultStroke ? {stroke: {value: defaultStroke}} : {})\n  };\n\n  if (markDef.color && (filled ? markDef.fill : markDef.stroke)) {\n    log.warn(log.message.droppingColor('property', {fill: 'fill' in markDef, stroke: 'stroke' in markDef}));\n  }\n\n  return {\n    ...fillStrokeMarkDefAndConfig,\n    ...nonPosition('color', model, {\n      vgChannel: colorVgChannel,\n      defaultValue: filled ? defaultFill : defaultStroke\n    }),\n    ...nonPosition('fill', model, {\n      // if there is encoding.fill, include default fill just in case we have conditional-only fill encoding\n      defaultValue: encoding.fill ? defaultFill : undefined\n    }),\n    ...nonPosition('stroke', model, {\n      // if there is encoding.stroke, include default fill just in case we have conditional-only stroke encoding\n      defaultValue: encoding.stroke ? defaultStroke : undefined\n    })\n  };\n}\n"]}